<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>The ZipArchive Library: ZipMemFile.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff" leftmargin="32" marginwidth="32" topmargin="32" marginheight="32">
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>ZipMemFile.h</h1><a href="ZipMemFile_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//&lt;!-- Code:License --&gt;</span>
<a name="l00002"></a>00002 
<a name="l00008"></a>00008 <span class="preprocessor">#if !defined(ZIPARCHIVE_ZIPMEMFILE_DOT_H)</span>
<a name="l00009"></a><a class="code" href="ZipMemFile_8h.html#96fb73e21b7943ac9ccb53dab6b72899">00009</a> <span class="preprocessor"></span><span class="preprocessor">#define ZIPARCHIVE_ZIPMEMFILE_DOT_H</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#if _MSC_VER &gt; 1000</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor">#pragma once</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#endif // _MSC_VER &gt; 1000</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "ZipAbstractFile.h"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "ZipString.h"</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "ZipExport.h"</span>
<a name="l00018"></a>00018 
<a name="l00023"></a><a class="code" href="classCZipMemFile.html">00023</a> <span class="keyword">class </span>ZIP_API <a class="code" href="classCZipMemFile.html">CZipMemFile</a> : <span class="keyword">public</span> CZipAbstractFile
<a name="l00024"></a>00024 {
<a name="l00025"></a>00025 <span class="keyword">protected</span>:
<a name="l00026"></a><a class="code" href="classCZipMemFile.html#2fd5bd1eeb006fc44c7a9623b715e1fa">00026</a>  size_t m_nGrowBy, m_nPos;
<a name="l00027"></a><a class="code" href="classCZipMemFile.html#ab0c2362bb6a58df6ec2f47768d95402">00027</a>  size_t m_nBufSize, m_nDataSize;
<a name="l00028"></a><a class="code" href="classCZipMemFile.html#dfd599bc538a9b257e368dd54e583bb7">00028</a>  BYTE* m_lpBuf;
<a name="l00029"></a><a class="code" href="classCZipMemFile.html#0ce8056a8731e2e49e559bc051907591">00029</a>  <span class="keywordtype">bool</span> m_bAutoDelete;
<a name="l00030"></a><a class="code" href="classCZipMemFile.html#48b4260e964f2f50e8977b5770296f2d">00030</a>  <span class="keywordtype">void</span> Free()
<a name="l00031"></a>00031  {
<a name="l00032"></a>00032   <span class="keywordflow">if</span> (m_lpBuf)
<a name="l00033"></a>00033   {
<a name="l00034"></a>00034    free(m_lpBuf);
<a name="l00035"></a>00035    m_lpBuf = NULL;
<a name="l00036"></a>00036   }
<a name="l00037"></a>00037  }
<a name="l00038"></a><a class="code" href="classCZipMemFile.html#fd14dd00ad8c4b0910159e751a981ad2">00038</a>  <span class="keywordtype">void</span> Init()
<a name="l00039"></a>00039  {
<a name="l00040"></a>00040   m_nGrowBy = m_nPos = 0;
<a name="l00041"></a>00041   m_nBufSize = m_nDataSize = 0;
<a name="l00042"></a>00042   m_lpBuf = NULL;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044  }
<a name="l00045"></a>00045  <span class="keywordtype">void</span> Grow(size_t nBytes);
<a name="l00046"></a>00046 <span class="keyword">public</span>:
<a name="l00047"></a><a class="code" href="classCZipMemFile.html#252af1cb9b266e6784c701c160241062">00047</a>  <span class="keywordtype">bool</span> IsClosed()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_lpBuf == NULL;}
<a name="l00048"></a><a class="code" href="classCZipMemFile.html#3656dcdc57afe44fef5385d7b5f0b998">00048</a>  <span class="keywordtype">void</span> Flush(){}
<a name="l00049"></a>00049 
<a name="l00050"></a>00050  ZIP_FILE_USIZE Seek(ZIP_FILE_SIZE lOff, <span class="keywordtype">int</span> nFrom);
<a name="l00051"></a><a class="code" href="classCZipMemFile.html#2532d3b6daa2315242919d0e2cbeaafe">00051</a>  ZIP_FILE_USIZE GetLength()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_nDataSize;}
<a name="l00052"></a>00052  <span class="keywordtype">void</span> Write(<span class="keyword">const</span> <span class="keywordtype">void</span>* lpBuf, UINT nCount);
<a name="l00053"></a>00053  UINT Read(<span class="keywordtype">void</span>* lpBuf, UINT nCount);
<a name="l00054"></a>00054  <span class="keywordtype">void</span> SetLength(ZIP_FILE_USIZE nNewLen);
<a name="l00055"></a><a class="code" href="classCZipMemFile.html#4cd0fdd0f826921d5ed9b5b8fbd72701">00055</a>  CZipString GetFilePath()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> _T(<span class="stringliteral">""</span>);}  
<a name="l00056"></a><a class="code" href="classCZipMemFile.html#00edf06e4cd9953917966eb0a6aa48c3">00056</a>  <a class="code" href="classCZipMemFile.html">CZipMemFile</a>(<span class="keywordtype">long</span> nGrowBy = 1024)
<a name="l00057"></a>00057  {
<a name="l00058"></a>00058   Init();
<a name="l00059"></a>00059   m_nGrowBy = nGrowBy;
<a name="l00060"></a>00060   m_bAutoDelete = <span class="keyword">true</span>;
<a name="l00061"></a>00061  }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063  
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="classCZipMemFile.html#c2f62e15c29390229f1a0be88544b363">00065</a>  <a class="code" href="classCZipMemFile.html">CZipMemFile</a>(BYTE* lpBuf, UINT nBufSize, <span class="keywordtype">long</span> nGrowBy = 0)
<a name="l00066"></a>00066  {
<a name="l00067"></a>00067   Init();
<a name="l00068"></a>00068   Attach(lpBuf, nBufSize, nGrowBy);
<a name="l00069"></a>00069  }
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classCZipMemFile.html#bb16f494ebab4fdc190b3924d688f137">00071</a>  <a class="code" href="classCZipMemFile.html">CZipMemFile</a>(<a class="code" href="classCZipMemFile.html">CZipMemFile</a>&amp; from)
<a name="l00072"></a>00072  {
<a name="l00073"></a>00073   Copy(from);
<a name="l00074"></a>00074  }
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="classCZipMemFile.html#dab656a763cafb98a37f9a1662b7aa3e">00076</a>  <span class="keywordtype">void</span> Copy(<a class="code" href="classCZipMemFile.html">CZipMemFile</a>&amp; from)
<a name="l00077"></a>00077  {
<a name="l00078"></a>00078   SetLength(from.<a class="code" href="classCZipMemFile.html#ab0c2362bb6a58df6ec2f47768d95402">m_nDataSize</a>);
<a name="l00079"></a>00079   from.<a class="code" href="classCZipMemFile.html#436402a0409a80bf677ccb4ca8c85813">Read</a>(m_lpBuf, (UINT)from.<a class="code" href="classCZipMemFile.html#ab0c2362bb6a58df6ec2f47768d95402">m_nDataSize</a>);
<a name="l00080"></a>00080  }
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classCZipMemFile.html#19e85ecf1c0b793fc6e48c8a3f6ac7e9">00082</a>  ZIP_FILE_USIZE GetPosition()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_nPos;}
<a name="l00083"></a><a class="code" href="classCZipMemFile.html#2d9a4ea572b8c5797a5e0a81e05a23fb">00083</a>  <span class="keywordtype">void</span> Attach(BYTE* lpBuf, UINT nBufSize, <span class="keywordtype">long</span> nGrowBy = 0)
<a name="l00084"></a>00084  {
<a name="l00085"></a>00085   Close();
<a name="l00086"></a>00086   m_lpBuf = lpBuf;
<a name="l00087"></a>00087   m_nGrowBy = nGrowBy;
<a name="l00088"></a>00088   m_nBufSize = nBufSize;
<a name="l00089"></a>00089   m_nDataSize = nGrowBy == 0 ? nBufSize : 0;
<a name="l00090"></a>00090   m_bAutoDelete = <span class="keyword">false</span>;
<a name="l00091"></a>00091  }
<a name="l00092"></a><a class="code" href="classCZipMemFile.html#9e3bbacc91ffdc58e222629a69b0d81c">00092</a>  BYTE* Detach()
<a name="l00093"></a>00093  {
<a name="l00094"></a>00094   BYTE* b = m_lpBuf;
<a name="l00095"></a>00095   Init();
<a name="l00096"></a>00096   <span class="keywordflow">return</span> b;
<a name="l00097"></a>00097  }
<a name="l00098"></a><a class="code" href="classCZipMemFile.html#9d12379e5f5335e7c4c7391252d06f75">00098</a>  <span class="keywordtype">void</span> Close()
<a name="l00099"></a>00099  {
<a name="l00100"></a>00100   <span class="keywordflow">if</span> (m_bAutoDelete)
<a name="l00101"></a>00101    Free();
<a name="l00102"></a>00102   Init();
<a name="l00103"></a>00103  }
<a name="l00104"></a><a class="code" href="classCZipMemFile.html#8faa484c478f66b3777ea655871846ff">00104</a>  <span class="keyword">virtual</span> ~<a class="code" href="classCZipMemFile.html">CZipMemFile</a>(){Close();}
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 };
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="preprocessor">#endif // !defined(ZIPARCHIVE_ZIPMEMFILE_DOT_H)</span>
</pre></div><hr><address><small>
The ZipArchive Library Copyright &copy;&nbsp;2000 - 2006 Tadeusz Dracz. Generated at Mon Nov 27 21:42:23 2006.
</small></address>
</body>
</html>
